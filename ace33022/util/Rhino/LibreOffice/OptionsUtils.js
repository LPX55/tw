/** * * OptionsUtils * * @author ace * * @version 2015/11/24 初始版本。 * * @see <a href="https://developer.mozilla.org/zh-TW/docs/JavaScript">JavaScript</a> * */var insertMonthOptions = function(spread, productCode, year, month) {	function getBeginTrnDate() {			var sheet = spread.getSheets().getByName('options_call_day_trn_logs');				return sheet.getObject().getCellByPosition(0, 1).getFormula();	}		function getEndTrnDate() {			var sheet = spread.getSheets().getByName('options_call_day_trn_logs');			var cellRange = Packages.com.sun.star.uno.UnoRuntime.queryInterface(Packages.com.sun.star.sheet.XSheetCellRange, sheet.getObject().getCellRangeByName('A1'));		var cursor = sheet.getObject().createCursorByRange(cellRange);		var usedCursor = Packages.com.sun.star.uno.UnoRuntime.queryInterface(Packages.com.sun.star.sheet.XUsedAreaCursor, cursor);				var addr;			usedCursor.gotoStartOfUsedArea(false);		usedCursor.gotoEndOfUsedArea(true);			addr = Packages.com.sun.star.uno.UnoRuntime.queryInterface(Packages.com.sun.star.sheet.XCellRangeAddressable, usedCursor);			// Packages.javax.swing.JOptionPane.showMessageDialog(null, addr.getRangeAddress().EndRow);				return sheet.getObject().getCellByPosition(0, addr.getRangeAddress().EndRow).getFormula();	}	  var sheet;	  sheet = spread.getSheets().getByName('options_call_day_trn_logs');  if (sheet != null) insertOptionsCallDayTrnLogs(sheet, productCode, year, month);  sheet = spread.getSheets().getByName('options_put_day_trn_logs');  if (sheet != null) insertOptionsPutDayTrnLogs(sheet, productCode, year, month);  sheet = spread.getSheets().getByName('options_call_large_stay_logs');  if (sheet != null) insertOptionsCallLargeStayLogs(sheet, productCode, year, month);  sheet = spread.getSheets().getByName('options_put_large_stay_logs');  if (sheet != null) insertOptionsPutLargeStayLogs(sheet, productCode, year, month);	  sheet = spread.getSheets().getByName('options_call_large_stay_all_logs');  if (sheet != null) insertOptionsCallLargeStayAllLogs(sheet, productCode, getBeginTrnDate(), getEndTrnDate());  sheet = spread.getSheets().getByName('options_put_large_stay_all_logs');  if (sheet != null) insertOptionsPutLargeStayAllLogs(sheet, productCode, getBeginTrnDate(), getEndTrnDate());	  sheet = spread.getSheets().getByName('foreign_options_day_trn_logs');  if (sheet != null) insertForeignOptionsDayTrnLogs(sheet, productCode, getBeginTrnDate(), getEndTrnDate());	  sheet = spread.getSheets().getByName('dealer_options_day_trn_logs');  if (sheet != null) insertDealerOptionsDayTrnLogs(sheet, productCode, getBeginTrnDate(), getEndTrnDate());	  sheet = spread.getSheets().getByName('invest_options_day_trn_logs');  if (sheet != null) insertInvestOptionsDayTrnLogs(sheet, productCode, getBeginTrnDate(), getEndTrnDate());};var insertOptionsDayTrnLogsToSheet = function(arrVO, sheet) {  var vo;	  var index;  var posX = new Number(0);  var posY = new Number(1);	  for (index = 0; index < arrVO.length; index++) {		vo = arrVO[index];				    posX = 0;		    sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getTrnDate());    sheet.getObject().getCellByPosition(posX++, posY).setFormula(vo.getConMonth());		sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getStrikePrice());    sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getOpenPrice());    sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getHighPrice());    sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getLowPrice());    sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getClosePrice());    sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getLastCalPrice());    sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getTrnQty());    sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getStayQty());		    posY++;  }};var insertOptionsCallDayTrnLogs = function(sheet, productCode, year, month) {	load(tw.ace33022.RequireJSConfig.baseUrl + tw.ace33022.RequireJSConfig.paths["tw.ace33022.dao.db.vo.OptionsCallDayTrnLogs"] + '.js');  var dao = new tw.ace33022.dao.db.vo.OptionsCallDayTrnLogs(Configurations.Database.getConnection());	var arrVO = dao.doSelectByConMonthOrderByTrnDateAndStrikePrice(productCode, new String(year + month));		insertOptionsDayTrnLogsToSheet(arrVO, sheet);};var insertOptionsPutDayTrnLogs = function(sheet, productCode, year, month) {	load(tw.ace33022.RequireJSConfig.baseUrl + tw.ace33022.RequireJSConfig.paths['tw.ace33022.dao.db.vo.OptionsPutDayTrnLogs'] + '.js');  var dao = new tw.ace33022.dao.db.vo.OptionsPutDayTrnLogs(Configurations.Database.getConnection());  var arrVO = dao.doSelectByConMonthOrderByTrnDateAndStrikePrice(productCode, new String(year + month));		insertOptionsDayTrnLogsToSheet(arrVO, sheet);};var insertOptionsLargeStayLogsToSheet = function(arrVO, sheet) {  var vo;	  var index;  var posX = new Number(0);  var posY = new Number(1);	  for (index = 0; index < arrVO.length; index++) {		vo = arrVO[index];				    posX = 0;		    sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getTrnDate());		sheet.getObject().getCellByPosition(posX++, posY).setFormula(vo.getConMonth());    // sheet.getObject().getCellByPosition(posX++, posY).setFormula(vo.getProductCode());		sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getPreFiveBuy());    sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getPreFiveJurBuy());		sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getPreTenBuy());    sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getPreTenJurBuy());		sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getPreFiveSell());    sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getPreFiveJurSell());		sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getPreTenSell());    sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getPreTenJurSell());		sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getStayQty());		    posY++;  }};var insertOptionsCallLargeStayLogs = function(sheet, productCode, year, month) {	load(tw.ace33022.RequireJSConfig.baseUrl + tw.ace33022.RequireJSConfig.paths['tw.ace33022.dao.db.vo.OptionsCallLargeStayLogs'] + '.js');		var conMonth = new String(year + month);  var dao = new tw.ace33022.dao.db.vo.OptionsCallLargeStayLogs(Configurations.Database.getConnection());  var arrVO = dao.doSelectByConMonthOrderByTrnDate(productCode, conMonth);		insertOptionsLargeStayLogsToSheet(arrVO, sheet);};var insertOptionsPutLargeStayLogs = function(sheet, productCode, year, month) {	load(tw.ace33022.RequireJSConfig.baseUrl + tw.ace33022.RequireJSConfig.paths['tw.ace33022.dao.db.vo.OptionsPutLargeStayLogs'] + '.js');		var conMonth = new String(year + month);  var dao = new tw.ace33022.dao.db.vo.OptionsPutLargeStayLogs(Configurations.Database.getConnection());	var arrVO = dao.doSelectByConMonthOrderByTrnDate(productCode, conMonth);		insertOptionsLargeStayLogsToSheet(arrVO, sheet);};var insertOptionsLargeStayAllLogsToSheet = function(arrVO, sheet) {  var vo;	  var index;  var posX = new Number(0);  var posY = new Number(1);	  for (index = 0; index < arrVO.length; index++) {		vo = arrVO[index];				    posX = 0;		    sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getTrnDate());    // sheet.getObject().getCellByPosition(posX++, posY).setFormula(vo.getProductCode());		sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getPreFiveBuy());    sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getPreFiveJurBuy());		sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getPreTenBuy());    sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getPreTenJurBuy());		sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getPreFiveSell());    sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getPreFiveJurSell());		sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getPreTenSell());    sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getPreTenJurSell());		sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getStayQty());		    posY++;  }};var insertOptionsCallLargeStayAllLogs = function(sheet, productCode, beginTrnDate, endTrnDate) {	load(tw.ace33022.RequireJSConfig.baseUrl + tw.ace33022.RequireJSConfig.paths['tw.ace33022.dao.db.vo.OptionsCallLargeStayAllLogs'] + '.js');  var dao = new tw.ace33022.dao.db.vo.OptionsCallLargeStayAllLogs(Configurations.Database.getConnection());  var arrVO = dao.doSelectBetweenTrnDateOrderByTrnDate(beginTrnDate, endTrnDate, productCode);		insertOptionsLargeStayAllLogsToSheet(arrVO, sheet);};var insertOptionsPutLargeStayAllLogs = function(sheet, productCode, beginTrnDate, endTrnDate) {	load(tw.ace33022.RequireJSConfig.baseUrl + tw.ace33022.RequireJSConfig.paths['tw.ace33022.dao.db.vo.OptionsPutLargeStayAllLogs'] + '.js');  var dao = new tw.ace33022.dao.db.vo.OptionsPutLargeStayAllLogs(Configurations.Database.getConnection());	var arrVO = dao.doSelectBetweenTrnDateOrderByTrnDate(beginTrnDate, endTrnDate, productCode);		insertOptionsLargeStayAllLogsToSheet(arrVO, sheet);};var insertFoundationOptionsDayTrnLogsToSheet = function(arrVO, sheet) {  var vo;	  var index;  var posX = new Number(0);  var posY = new Number(1);	  for (index = 0; index < arrVO.length; index++) {		vo = arrVO[index];				    posX = 0;		    sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getTrnDate());		sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getCallBuyQty());    sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getCallBuyTotal());    sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getCallSellQty());    sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getCallSellTotal());		sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getPutBuyQty());    sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getPutBuyTotal());    sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getPutSellQty());    sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getPutSellTotal());		sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getStayCallBuyQty());    sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getStayCallBuyTotal());    sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getStayCallSellQty());    sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getStayCallSellTotal());		sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getStayPutBuyQty());    sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getStayPutBuyTotal());    sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getStayPutSellQty());    sheet.getObject().getCellByPosition(posX++, posY).setValue(vo.getStayPutSellTotal());		    posY++;  }};var insertForeignOptionsDayTrnLogs = function(sheet, productCode, beginTrnDate, endTrnDate) {	load(tw.ace33022.RequireJSConfig.baseUrl + tw.ace33022.RequireJSConfig.paths['tw.ace33022.dao.db.vo.ForeignOptionsDayTrnLogs'] + '.js');  var dao = new tw.ace33022.dao.db.vo.ForeignOptionsDayTrnLogs(Configurations.Database.getConnection());  var arrVO = dao.doSelectBetweenTrnDateOrderByTrnDate(beginTrnDate, endTrnDate, productCode);		insertFoundationOptionsDayTrnLogsToSheet(arrVO, sheet);};var insertDealerOptionsDayTrnLogs = function(sheet, productCode, beginTrnDate, endTrnDate) {	load(tw.ace33022.RequireJSConfig.baseUrl + tw.ace33022.RequireJSConfig.paths['tw.ace33022.dao.db.vo.DealerOptionsDayTrnLogs'] + '.js');  var dao = new tw.ace33022.dao.db.vo.DealerOptionsDayTrnLogs(Configurations.Database.getConnection());  var arrVO = dao.doSelectBetweenTrnDateOrderByTrnDate(beginTrnDate, endTrnDate, productCode);		insertFoundationOptionsDayTrnLogsToSheet(arrVO, sheet);};var insertInvestOptionsDayTrnLogs = function(sheet, productCode, beginTrnDate, endTrnDate) {	load(tw.ace33022.RequireJSConfig.baseUrl + tw.ace33022.RequireJSConfig.paths['tw.ace33022.dao.db.vo.InvestOptionsDayTrnLogs'] + '.js');  var dao = new tw.ace33022.dao.db.vo.InvestOptionsDayTrnLogs(Configurations.Database.getConnection());  var arrVO = dao.doSelectBetweenTrnDateOrderByTrnDate(beginTrnDate, endTrnDate, productCode);		insertFoundationOptionsDayTrnLogsToSheet(arrVO, sheet);};